# í™©ê¸ˆì™• ê³¨ë“œí‚¹ í¬íŒ… ë§¤ë‰´ì–¼

# 0. ëª©ì°¨

## 1. ê¸°ìˆ  ìŠ¤íƒ ë° ê°œë°œ í™˜ê²½

## 2. ì•„í‚¤í…ì²˜

## 3. í¬íŠ¸ ì„¤ì •

## 4. ì„¸ë¶€ ì„¤ì •

### (1) Docker & Docker Compose

### (2) Perforce

### (3) Jenkins

### (4) MySQL

### (5) Jenkinsë¥¼ í†µí•œ Spring Boot í”„ë¡œì íŠ¸ ë¹Œë“œ

## 5. ì™¸ë¶€ ì„œë¹„ìŠ¤(EOS SDK)

# 1. ê¸°ìˆ  ìŠ¤íƒ ë° ê°œë°œ í™˜ê²½

### | **í˜•ìƒ ê´€ë¦¬**

- GitLab 16.0.5
- Perforce 2023.2

### | **ì´ìŠˆ ê´€ë¦¬**

- Jira

### | Communication

- MatterMost (7.8.6)
- GatherTown
- Notion
- WebEx
- Discord

### | **OS**

- Windows 10
- Ubuntu - 20.04 LTS

### | Design

- Figma
- Photoshop

### | Server

- AWS-EC2 - t2.xlarge
    - Ubuntu - 20.04 LTS
- Docker - 24.0.4
    - Docker Compose -
- EOS SDK - 1.16.1
- Java - 17.0.7
- Spring boot - 3.1.1
- Spring Data Jpa - 3.1.1
- Lombok - 1.18.28
- Jenkins

### | Client

- Unreal Engine (5.2.18)

### | IDE

- Visual Studio 2022
- IntelliJ Ultimate

### | ETC..

- ChatGPT

### | DB

- MySQL - 8.0.33

# 2. ì•„í‚¤í…ì²˜

![Untitled](manual/Untitled.png)

# 3. í¬íŠ¸

| APP | EC2 | Container |
| --- | --- | --- |
| Perforce Helix Server | 10001/tcp | 1666/tcp |
| Spring | 8080/tcp | 8080/tcp |
| Jenkins | 8081/tcp
50000/tcp | 8080/tcp
50000/tcp |
| MySQL | 3306/tcp | 3306/tcp |

# 4. ì„¸ë¶€ ì„¤ì •

## (1) Docker & Docker Compose ([ê´€ë ¨ ë¬¸ì„œ](https://docs.docker.com/engine/install/ubuntu/))

EC2 ì¸ìŠ¤í„´ìŠ¤ì˜ ì‰˜ì—ì„œ ë‹¤ìŒê³¼ ê°™ì€ ì»¤ë§¨ë“œë¡œ ì„¤ì¹˜í•©ë‹ˆë‹¤. ì•„ë˜ëŠ” ëª¨ë‘ Docker Composeë¥¼ ì´ìš©í•´ Docker ì»¨í…Œì´ë„ˆ ë‚´ì—ì„œ ê´€ë¦¬ë˜ê³  ìˆìŠµë‹ˆë‹¤.

```bash
# Add Docker's official GPG key:
sudo apt-get update
sudo apt-get install ca-certificates curl gnupg
sudo install -m 0755 -d /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
sudo chmod a+r /etc/apt/keyrings/docker.gpg

# Add the repository to Apt sources:
echo \
  "deb [arch="$(dpkg --print-architecture)" signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \
  "$(. /etc/os-release && echo "$VERSION_CODENAME")" stable" | \
  sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
sudo apt-get update
```

```bash
sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
```

---

## (2) Perforce

# 0ï¸âƒ£ í˜„ì¬ ì„¸íŒ…

<aside>
ğŸ ì„œë²„ ì£¼ì†Œ : j9a203.p.ssafy.io:10001
ìŠˆí¼ ìœ ì € id: super 
ìŠˆí¼ ìœ ì € pw: ì§ê³§íŒ€!

</aside>

| ì‚¬ìš©ì | id | pw |
| --- | --- | --- |
| ë¯¼ì˜ | ymy | ìœ¤ë¯¼ì˜! |
| ì •ì¤€ | ljj | ì´ì •ì¤€! |
| í•˜ë¦¼ | khr | ê¹€í•˜ë¦¼! |
| ê±´ | gun | ê±´ì˜ì„œ! |

### 1ï¸âƒ£ Overview ([ë§í¬](https://www.perforce.com/manuals/overview/Content/Overview/Home-overview.html))

### [1] ê¸°ë³¸ì ì¸ ë²„ì „ ì»¨íŠ¸ë¡¤ Workflow

1. íŠ¹ì • ë ˆí¬ì§€í† ë¦¬ì— ì• ì…‹ì´ ìˆë‹¤.
2. ì• ì…‹ì—ëŠ” ìœ ì €ë“¤ì´ ì´ë¥¼ ì½ê±°ë‚˜ ìˆ˜ì •í•˜ê¸° ìœ„í•œ ê¶Œí•œì´ ì£¼ì–´ì ¸ ìˆë‹¤.
3. í•œ ê¶Œí•œ ìˆëŠ” ìœ ì €ê°€ ì• ì…‹ì„ ë¡œì»¬ë¡œ ë³µì‚¬í•´ ìˆ˜ì • ì‘ì—…ì„ í•˜ê³ ,
4. ë‹¤ë¥¸ í•œ ìœ ì €ë„ ë§ˆì°¬ê°€ì§€ë¡œ í•´ë‹¹ ì• ì…‹ì„ ë³µì‚¬í•´ì„œ ì‘ì—…í–ˆë‹¤ê³  í•˜ì.
5. ì²« ìœ ì €ê°€ ë¡œì»¬ ì‘ì—… ë³µì‚¬ë³¸ì„ ì²´í¬ ì¸ í–ˆì„ ë•Œ, 
6. ë‹¤ë¥¸ ìœ ì €ë„ í•´ë‹¹ ì• ì…‹ì— ëŒ€í•´ ì‘ì—…ì„ í•˜ê³  ë³µì‚¬ë³¸ì„ check iní•˜ë ¤ê³  í•˜ë©´ ë²„ì „ ì»¨íŠ¸ë¡¤ ì‹œìŠ¤í…œì€ ë‘ ë²ˆì§¸ ìœ ì €ì—ê²Œ í•´ë‹¹ íŒŒì¼ì´ ì´ë¯¸ ì²« ë²ˆì§¸ ìœ ì €ì— ì˜í•´ ìˆ˜ì •ëœ ê²ƒì„ì„ ì•Œë ¤ì•¼ í•œë‹¤. (Conflictë¥¼ resolveí•  ìˆ˜ ìˆê²Œ)

ë²„ì „ ê´€ë¦¬ ì‹œìŠ¤í…œì€ ì¤‘ì•™ ì§‘ì¤‘í˜•ì´ê±°ë‚˜ ë¶„ì‚°í˜•ì´ë‹¤. Helix ServerëŠ” ì´ ë‘˜ì„ ëª¨ë‘ ì§€ì›í•˜ê³ , ë‘˜ì´ ì„ì¸ ë°©ì‹ë„ ì§€ì›í•œë‹¤.

### [2] Helix Server as a version control implementation

Helix ì„œë²„ëŠ” ë²„ì „ ì»¨íŠ¸ë¡¤ ê´€ë¦¬ë¥¼ êµ¬í˜„í•˜ê¸° ìœ„í•´ í´ë¼ì´ì–¸íŠ¸-ì„œë²„ êµ¬ì¡°ë¥¼ ì‚¬ìš©í•œë‹¤.

**(1) Helix Server (Helix Core Server, `p4d`)**

Helix ì„œë²„ëŠ” ê³µìœ  íŒŒì¼ ë ˆí¬ì§€í† ë¦¬, í˜¹ì€ ë””í¬ë¥¼ ê´€ë¦¬í•œë‹¤. ì´ ë””í¬ì—ëŠ” ë²„ì „ ê´€ë¦¬ ëŒ€ìƒì´ ë˜ëŠ” ëª¨ë“  ê° íŒŒì¼ë“¤ì˜ ìˆ˜ì • ë‚´ì—­ì´ í¬í•¨ë˜ì–´ ìˆë‹¤. íŒŒì¼ë“¤ì€ ë””ë ‰í† ë¦¬ íŠ¸ë¦¬ë¡œ ì¡°ì§ë˜ì–´ìˆë‹¤. ì´ ì„œë²„ëŠ” ë˜í•œ íŒŒì¼ë“¤ê³¼, í˜¹ì€ í´ë¼ì´ì–¸íŠ¸ì˜ í™œë™ê³¼ ì—°ê´€ëœ ë°ì´í„°ë“¤ì„ ì¶”ì í•˜ê¸° ìœ„í•œ DBë„ ê°€ì§€ê³  ìˆë‹¤. (ì˜ˆ. logs, user permissions, metadata, configuration values ë“±)

**(2) Helix Server Client**

Helix ì„œë²„ í´ë¼ì´ì–¸íŠ¸ëŠ” íŒŒì¼ì„ ë””í¬ë¡œë¶€í„° check in/outí•˜ê±°ë‚˜, ì¶©ëŒì„ resolveí•˜ê±°ë‚˜ í•˜ëŠ” ë“±ì˜ ì‘ì—…ë“¤ì„ í•˜ê¸° ìœ„í•œ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•œë‹¤. ì—¬ê¸°ì—ëŠ” CLI client(`p4`)ì™€ **GUI client(`p4v`)**ê°€ í¬í•¨ë¼ìˆë‹¤.

ë””í¬ì— ìˆëŠ” ë ˆí¬ì§€í† ë¦¬ë“¤ì€ ìœ ì €ì˜ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì— ìˆëŠ” ë ˆí¬ì§€í† ë¦¬ì— ë§¤í•‘ë˜ê³ , ìœ ì €ëŠ” ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì— ìˆëŠ” íŒŒì¼ë“¤ë¡œ ì‘ì—…í•œë‹¤.

> *Depot : Workspace = Remote : Local*
> 
1. ë””í¬ì— ìˆëŠ” íŒŒì¼ë“¤ì„ ìœ ì € ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë¡œ ì²´í¬ ì•„ì›ƒ
2. íŒŒì¼ ìˆ˜ì •
3. ìˆ˜ì •ëœ íŒŒì¼ì„ ë””í¬ë¡œ ì²´í¬ ì¸
4. ë§Œì•½ ì¶©ëŒ ë°œìƒí•˜ë©´ resolveí•´ì•¼ í•¨

íŒŒì¼ë“¤ì„ ì²´í¬ ì¸-ì•„ì›ƒí•˜ê¸° ìœ„í•´ì„œëŠ” Changelistë¥¼ ì‚¬ìš©. ChangelistëŠ” ì ì–´ë„ í•˜ë‚˜ì˜ íŒŒì¼ë“¤ì„ í¬í•¨í•˜ê³ , ìˆ˜ ë§Œ ê°œì˜ íŒŒì¼ë“¤ì„ í¬í•¨í•  ìˆ˜ë„ ìˆìŒ. ì´ ChangelistëŠ” ë²ˆí˜¸ ë§¤ê²¨ì ¸ì„œ ë””í¬ ë‚´ìš©ì˜ ëª¨ë“  ë³€í™”ë“¤ì„ ì¶”ì í•  ìˆ˜ ìˆê²Œ í•¨.

### [3] Multiple user access to a set of files

Helix ServerëŠ” ë‹¤ìŒì˜ ë‘ ë°©ë²•ìœ¼ë¡œ ì—¬ëŸ¬ ì‚¬ìš©ìë“¤ì´ ê°™ì€ í”„ë¡œì íŠ¸ì— ëŒ€í•´ ë™ì‹œì— ì‘ì—…í•  ìˆ˜ ìˆë„ë¡ í•¨

- File Locking : í•œ ëª…ì´ ì‘ì—…í•˜ê³  ìˆëŠ” íŒŒì¼ì´ ìˆìœ¼ë©´ ë½ì„ ê±¸ì–´ì„œ ë‹¤ë¥¸ ìœ ì €ë“¤ì´ ìˆ˜ì •í•˜ëŠ” ê²ƒì„ ë§‰ì„ ìˆ˜ ìˆìŒ.
- Branching and Merging : ë¸Œëœì¹­, ë¨¸ì§•í•´ì„œ ì—¬ëŸ¬ ìœ ì €ë“¤ì´ ê°™ì€ íŒŒì¼ì„ ë™ì‹œì— ìˆ˜ì •í•  ìˆ˜ ìˆìŒ.

## 2ï¸âƒ£ Helix Core Server Administrator ([ë§í¬](https://www.perforce.com/manuals/p4sag/Content/P4SAG/Home-p4sag.html))

### [1] Helix Core ì„¤ì¹˜

1. Helix Core ì„¤ì¹˜ ([ë§í¬](https://help.perforce.com/helix-core/quickstart/Content/quickstart/admin-install-linux.html))
2. ì„¤ì¹˜ í›„ì—ëŠ” [ì—¬ê¸°](https://www.perforce.com/manuals/p4sag/Content/P4SAG/install.linux.packages.configure.html)ì— ë”°ë¼ ì´ˆê¸° ì„¤ì • (ì„œë¹„ìŠ¤ ëª…, root ë””ë ‰í† ë¦¬ ëª…, í¬íŠ¸, ìŠˆí¼ ìœ ì € ì´ë¦„ê³¼ ë¹„ë°€ë²ˆí˜¸ ë“±)

## 3ï¸âƒ£ Helix Server Client

Helix Server Clientì—ëŠ” CLI(`p4`), GUI(`p4v`)ê°€ ìˆìŒ.

### [1] ì„¤ì¹˜ ë° ì ‘ì† ([ì„¤ì¹˜ ë§í¬](https://www.perforce.com/downloads/helix-visual-client-p4v))

**(1) `p4v` ì—°ê²°**

ì„¤ì¹˜í•œ `p4v`ë¥¼ ì—´ë©´ ì—°ê²°í•˜ëŠ” ì°½ì´ ëœ¹ë‹ˆë‹¤. í˜¹ì€ ìœ„ìª½ì—ì„œ 

Connection - Open Connectionì„ ëˆŒëŸ¬ ì—°ê²°í•´ì£¼ë©´ ë©ë‹ˆë‹¤.

Server, User, WorkspaceëŠ” ë°”ë€” ìˆ˜ ìˆìŠµë‹ˆë‹¤. (09.03 í˜„ì¬ëŠ” ì„ì‹œ EC2ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë¯€ë¡œ, ì¶”í›„ EC2 ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë”°ë¡œ ì§€ê¸‰ë°›ê³  í™•ì •ë˜ë©´ ê³µìœ )

â‡’ ìœ„ìª½ì— ì„¸íŒ…ì— ìˆëŠ” ì„œë²„ ì£¼ì†Œ + ìœ ì € ì•„ì´ë””ë¡œ ì ‘ì†í•˜ê³  ì›Œí¬ìŠ¤í˜ì´ìŠ¤ëŠ” newë¥¼ ëˆŒëŸ¬ í¸í•˜ì‹  ê³³ì— ì§€ì •í•˜ì‹œë©´ ë©ë‹ˆë‹¤. ì´í›„ OKë¥¼ ëˆ„ë¥´ë©´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì‹œë©´ ë©ë‹ˆë‹¤

### [2] ì‚¬ìš©ë²•

**(1) p4**

- [ì»¤ë§¨ë“œ ëª©ë¡](https://www.perforce.com/manuals/cmdref/Content/CmdRef/commands.html)

**(2) p4v**

- ì•„ë˜ 5ï¸âƒ£ **********************Perforce + Unreal ì—°ë™**********************ì—ì„œ ë‹¤ë£¹ë‹ˆë‹¤.

## 4ï¸âƒ£ Helix4Git & Git Connector ([ê³µì‹ë¬¸ì„œ](https://www.perforce.com/manuals//helix-for-git/Content/Helix4Git/chapter.overview.html))

### [1] Helix4Git?

**(1) Architecture & Components**

Helix4Gitì€ ë‘ ì»´í¬ë„ŒíŠ¸ë“¤ë¡œ ì´ë¤„ì ¸ ìˆë‹¤.

- Helix Server(p4d)
- Git Connector : Git í´ë¼ì´ì–¸íŠ¸ì—ê²Œ Git ì„œë²„ ì—­í• ì„ í•¨

Git ì‚¬ìš©ìëŠ” ë””í¬ì—ì„œ íŒŒì¼ë“¤ì„ ê°€ì ¸ì™€ ìˆ˜ì •í•˜ê³  í‘¸ì‹œí•˜ê¸° ìœ„í•´ì„œ Git í´ë¼ì´ì–¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ê³ , Git í´ë¼ì´ì–¸íŠ¸ëŠ” Git Connectorë¥¼ í†µí•´ Helix Serverì™€ ì†Œí†µí•œë‹¤.

**(2) Typical Scenario**

1. Git ì‚¬ìš©ìëŠ” Git Connectorë¡œ ìˆ˜ì • ì‚¬í•­ì„ í‘¸ì‹œ
2. Git ConnectorëŠ” ìˆ˜ì • ì‚¬í•­ì„ Helix Serverë¡œ í‘¸ì‹œ
3. CI ì„œë²„ (e.g. P4Jenkins)ëŠ” ìˆ˜ì • ì‚¬í•­ì„ íƒì§€í•˜ê³  í•œ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë¥¼ ì´ìš©í•´ì„œ ë¹Œë“œ

### [2] ì„¤ì¹˜ ë° ì„¤ì •

**(1) ì„¤ì¹˜ ([ì„¤ì¹˜ ë§í¬](https://www.perforce.com/manuals//helix-for-git/Content/Helix4Git/install-config.install.html))**

**(2) ì„¤ì • ([ì„¤ì • ë§í¬](https://www.perforce.com/manuals//helix-for-git/Content/Helix4Git/install-config.config.html))**

**(3) Git Connectorì— ë§ê²Œ Helix Server ì„¤ì •í•˜ê¸° ([ë§í¬](https://www.perforce.com/manuals//helix-for-git/Content/Helix4Git/install-config.setup-server.html))**

### [3] ì‚¬ìš©ë²•

`graph` íƒ€ì…ì˜ ë””í¬ `repo`ë¥¼ ë§Œë“¤ì–´ì„œ ì‚¬ìš©í•œë‹¤.

ë§Œì•½ ë‹¤ë¥¸ graph depotë¥¼ ë§Œë“œë ¤ë©´ `gconn-user`ì—ê²Œ admin ê¶Œí•œì„ ì¤˜ì•¼ í•œë‹¤.

**(1) Git Userì˜ Git Connector ì„¤ì • ([ë§í¬](https://www.perforce.com/manuals//helix-for-git/Content/Helix4Git/install-config.setup-users.html))**

**(2) Push, Clone, Pull í•˜ê¸° ([ë§í¬](https://www.perforce.com/manuals//helix-for-git/Content/Helix4Git/install-config.push-clone-pull-repos.https.html))**

### [4] â­ ë¯¸ëŸ¬ë§ ([ê³µì‹ë¬¸ì„œ](https://www.perforce.com/manuals//helix-for-git/Content/Helix4Git/chapter.mirroring.html))

Helix4Gitì€ GitHub, GitLab ë“±ì˜ Git ì„œë²„ë¡œì˜ ì»¤ë°‹ì„ Helix Core ì„œë²„ë¡œ ë³µì œí•  ìˆ˜ ìˆë‹¤.

ì  í‚¨ìŠ¤ ë“±ì˜ CI toolì„ í•˜ë‚˜ë§Œ ì´ìš©í•´ì„œ ë¹Œë“œí•˜ê¸° ìœ„í•´ì„œ í•„ìš”í•¨. 

ì›¹ í›…ì„ ì´ìš©í•´ì„œ í•´ë‹¹ ê¹ƒ ì„œë²„ë¡œ ì»¤ë°‹ì´ ë°œìƒí•˜ë©´ Git Connectorê°€ ì´ ì›¹ í›… ë©”ì‹œì§€ë¥¼ ë°›ì•„ì„œ, ë‹¤ì‹œ Helix Core ì„œë²„ë¡œ ë³´ë‚´ì£¼ëŠ” ë°©ì‹

```
[ê¹ƒë© ê¸°ì¤€]

1. sudo su git ìœ¼ë¡œ ë¡œê·¸ì¸
2. export GCONN_CONFIG=/opt/perforce/git-connector/gconn.conf í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
3. gconn --mirrorhooks add graphDepotName/repoName 
		https://access-token:secret@GitHost.com/project/repoName.git
4. 3ì˜ ê²°ê³¼ë¡œ ì–»ì„ ìˆ˜ ìˆëŠ” Webhook URL, Webhook secret tokenì„ ë³µì‚¬
5. ê¹ƒë© ë ˆí¬-Settings-Webhooksì— ì£¼ì†Œ/{Webhook URL}, Webhook secret token ì…ë ¥
6. SSL í™œì„±í™”.
7. ì›¹ í›… ìƒì„±
```

## 5ï¸âƒ£ Perforce + Unreal ì—°ë™

### [1] ê´€ë ¨ ë¬¸ì„œ

- [ê´€ë ¨ ë¬¸ì„œ(1)](https://www.perforce.com/integrations/perforce-and-unreal-integration)
- [ê´€ë ¨ ë¬¸ì„œ(2)](https://docs.unrealengine.com/5.2/en-US/using-perforce-as-source-control-for-unreal-engine/)

### [2] UE5 ê³µì‹ ë¬¸ì„œ ì •ë¦¬ ë° ì„¸íŒ… (ìœ„ ê´€ë ¨ ë¬¸ì„œ(2))

Perforceë¥¼ ì´ìš©í•˜ë©´ ì—ì…‹ê³¼ ì½”ë“œë¥¼ ë‹¤ë¥¸ íŒ€ì›ë“¤ê³¼ ê³µìœ í•  ìˆ˜ ìˆê³ , ë°±ì—… ë° ìˆ˜ì • ë‚´ì—­ì„ ì €ì¥í•´ ì–´ë–¤ íŒŒì¼ì— ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì„ ë•Œ ì´ì „ ë²„ì „ìœ¼ë¡œ ë¡¤ ë°± í•  ìˆ˜ ìˆë‹¤.

**(1) ì„¸íŒ… - P4 TypeMap**

ë””í¬ì— íŒŒì¼ë“¤ì„ ì˜¬ë¦¬ê¸° ì „ì— ë°˜ë“œì‹œ P4 TypeMapì„ ì„¤ì •í•´ì„œ Perforceê°€ Unrealì˜ íŒŒì¼ë“¤ì„ ì–´ë–»ê²Œ ëŒ€í•´ì•¼ í• ì§€ë¥¼ ëª…ì‹œí•´ì¤˜ì•¼ í•œë‹¤. ì´ë ‡ê²Œ í•˜ë ¤ë©´ ìš°ì„  ëª…ë ¹ í”„ë¡¬í”„íŠ¸ë¥¼ ì—´ì–´ì„œ p4 í™˜ê²½ ë³€ìˆ˜ë“¤ì„ ì„¤ì •í•´ì¤˜ì•¼ í•œë‹¤.

```
p4 set P4USER=your.username
p4 set P4PORT=localhost:1666

p4 -P YourPassword typemap
```

```
    # Perforce File Type Mapping Specifications.
    #
    #  TypeMap:             a list of filetype mappings; one per line.
    #                       Each line has two elements:
    #
    #                       Filetype: The filetype to use on 'p4 add'.
    #
    #                       Path:     File pattern which will use this filetype.
    #
    # See 'p4 help typemap' for more information.

    TypeMap:
                    binary+w //depot/....exe
                    binary+w //depot/....dll
                    binary+w //depot/....lib
                    binary+w //depot/....app
                    binary+w //depot/....dylib
                    binary+w //depot/....stub
                    binary+w //depot/....ipa
                    binary //depot/....bmp
                    text //depot/....ini
                    text //depot/....config
                    text //depot/....cpp
                    text //depot/....h
                    text //depot/....c
                    text //depot/....cs
                    text //depot/....m
                    text //depot/....mm
                    text //depot/....py
                    binary+l //depot/....uasset
                    binary+l //depot/....umap
                    binary+l //depot/....upk
                    binary+l //depot/....udk
                    binary+l //depot/....ubulk
```

> EC2ì— ë“¤ì–´ê°€ì„œ defaultë¡œ ìˆëŠ” typemap ë’¤ ìª½ì— ì¶”ê°€í•´ì¤¬ìŠµë‹ˆë‹¤.
> 

**(2) ì„¸íŒ… - í”„ë¡œì íŠ¸ë¥¼ Perforceì— ì˜¬ë¦¬ê¸°**

ë§Œë“¤ì–´ì§„ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì— depot í´ë”ë¥¼ ë§Œë“¤ê³  ì–¸ë¦¬ì–¼ í”„ë¡œì íŠ¸ í´ë”ë¥¼ ì‹¹ ë‹¤ ë³µë¶™í•©ë‹ˆë‹¤.

1. ì´ˆë¡ìƒ‰ìœ¼ë¡œ ì¹ í•´ì§„ ê²ƒë“¤ì€ ë°˜ë“œì‹œ í¼í¬ìŠ¤ depotì— ë“¤ì–´ê°€ì•¼ í•˜ê³ , Binaries í´ë”ëŠ” ì„ íƒì ì…ë‹ˆë‹¤.

> It is not required if every team member is going to compile their editor/game themselves, but should be included in theÂ **initial add**Â if any team members will just be grabbing a version from the depot to create content.
> 
- ì•„ë§ˆ ì €í¬ í”„ë¡œì íŠ¸ì—ì„œëŠ” í›„ìì¸ ê²ƒ ê°™ìœ¼ë¯€ë¡œ Initial addë¡œ ì¶”ê°€í•´ì¤¬ìŠµë‹ˆë‹¤.
1. ìœ„ì˜ í´ë”ë“¤ì„ ì„ íƒí•˜ê³  ì˜¤ë¥¸ìª½ í´ë¦­ í›„  **Mark for Add**ë¥¼ ëˆŒëŸ¬ change listì— ì¶”ê°€í•´ì¤ë‹ˆë‹¤.
- change listì— ì¶”ê°€í•  ë•Œì—ëŠ” defaultê°€ ì•„ë‹ˆë¼ newë¥¼ ì“°ê³ , ì„¸ë¶€ì ì¸ ë‚´ìš©ë“¤ì„ ì¨ì£¼ì„¸ìš”
1. íŒŒì¼ë“¤ì´ change listì— ì¶”ê°€ë˜ë©´ ì˜¤ë¥¸ìª½ì˜ Pendingì—ì„œ í˜„ì¬ ì¶”ê°€ëœ íŒŒì¼ë“¤ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    
    ![Untitled](manual/Untitled%201.png)
    
2. ë³€ê²½ëœ íŒŒì¼ ë‚´ì—­ì„ Perforceì— ì œì¶œí•˜ë ¤ë©´ Submitì„ í´ë¦­í•˜ë©´ ë©ë‹ˆë‹¤.

> ìœ„ëŠ” Perforceì— UE í”„ë¡œì íŠ¸ë¥¼ ì²˜ìŒ ì˜¬ë ¤ êµ¬ì„±í•  ë•Œì— ì”ë‹ˆë‹¤. ì´ í”„ë¡œì íŠ¸ì—ì„œëŠ” í•œ ëª…ì´ ì „ì²´ì ì¸ í”„ë¡œì íŠ¸ë¥¼ í•œ ë²ˆ ì˜¬ë¦¬ê³  ë‚˜ì„œëŠ” ëª¨ë‘ í•œ ë””í¬ë¥¼ ê³µìš©ìœ¼ë¡œ ì“°ê²Œ ë  ê²ƒì´ë¯€ë¡œ ìœ„ ì‘ì—…ì€ **í•œ ë²ˆë§Œ** í•˜ë©´ ë©ë‹ˆë‹¤.
> 

**(3) ì–¸ë¦¬ì–¼ ì—”ì§„ê³¼ì˜ ì—°ë™**

1. í”„ë¡œì íŠ¸ë¥¼ ì—´ê³  ë‚˜ë©´ ì˜¤ë¥¸ìª½ ì•„ë˜ì—ì„œ ë¦¬ë¹„ì „ ì»¨íŠ¸ë¡¤ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
2. ë¦¬ë¹„ì „ ì»¨íŠ¸ë¡¤ì„ ëˆŒëŸ¬ ë¦¬ë¹„ì „ ì»¨íŠ¸ë¡¤ ì„¸íŒ… ë³€ê²½ì„ í´ë¦­í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì°½ì´ ëœ¹ë‹ˆë‹¤
3. ì„œë²„ì™€ ì‚¬ìš©ìëª…, ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë¥¼ ì…ë ¥í•˜ê³  ì„¸íŒ… ìˆ˜ë½ì„ ëˆ„ë¥´ë©´ ëì…ë‹ˆë‹¤.

### [3] Workflow ([ê´€ë ¨ ì˜ìƒ](https://www.youtube.com/watch?v=ix4iaGr3kPI))

**(1) Remind**

> *Depot : Workspace = Remote : Local*
> 

**(2) Lock**

> For this reason, when working on a file the Editor will lock that file (this is known asÂ **Checking Out**Â in Perforce nomenclature) so that other users cannot concurrently edit it. When the user is done with editing the file(s) they have locked, they check in, or commit those files, uploading the changes to the server and releasing the lock on the file.
(ìœ„ ê³µì‹ ë¬¸ì„œ (2)ì— ì í˜€ìˆìŠµë‹ˆë‹¤)
> 

ë”°ë¡œ Lock í˜¹ì€ Checkout í•  í•„ìš” ì—†ì´ ì–¸ë¦¬ì–¼ ì—ë””í„°ì—ì„œ ë³€ê²½í•˜ë©´ ìë™ìœ¼ë¡œ check outë¼ì„œ ë‹¤ë¥¸ ì‚¬ìš©ìë“¤ì€ ê±´ë“œë¦´ ìˆ˜ ì—†ê²Œ ë©ë‹ˆë‹¤.

ë§¤ì¼ ì•„ì¹¨ ìŠ¤í¬ëŸ¼ì— ì–´ë–¤ ê±¸ ìˆ˜ì •í•  ê²ƒì¸ì§€ ì„œë¡œ ê³µìœ í•˜ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤

**(3) Branching ([ê³µì‹ ë¬¸ì„œ](https://www.perforce.com/manuals/p4v/Content/P4V/branches.create.html))**

1. ì†ŒìŠ¤ í´ë”ë‚˜ íŒŒì¼ì„ ì„ íƒí•˜ê³  ì˜¤ë¥¸ìª½ í´ë¦­í•´ì„œ **Branch Files**ë¥¼ ì„ íƒí•˜ë©´ ************Branch************ì°½ì´ ëœ¹ë‹ˆë‹¤
2. **Choose target files/folders** í•„ë“œì—ì„œ ì–´ë–¤ ë¸Œëœì¹˜ë¥¼ ë§Œë“¤ì§€ë¥¼ ëª…ì‹œí•©ë‹ˆë‹¤.
    1. ë§Œì•½ì— ì´ë¯¸ ìˆëŠ” ë¸Œëœì¹˜ë¥¼ ì…ë ¥í•˜ë©´ branchingì´ ì•„ë‹ˆë¼ mergingì´ ë©ë‹ˆë‹¤.
3. ì˜µì…˜ì„ ì„¤ì •í•˜ê³  **Branch**ë¥¼ í´ë¦­í•©ë‹ˆë‹¤.
4. auto-submit ì˜µì…˜ì„ ì„ íƒí•œ ê²½ìš°ì—ëŠ” pending changelistì—ì„œ ë°”ë¡œë°”ë¡œ submitë©ë‹ˆë‹¤.
    1. **Add files to pending changelist**ë¥¼ ì„ íƒí•˜ë©´, ì¤€ë¹„ë˜ì—ˆì„ ë•Œ ìˆ˜ë™ìœ¼ë¡œ submití•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**(4) Resolving ([ê³µì‹ ë¬¸ì„œ](https://www.perforce.com/manuals/p4v/Content/P4V/branches.resolve.html#Resolving_files))**

- ìë™ìœ¼ë¡œ check outì´ ë¼ì„œ conflictê°€ ì¼ì–´ë‚˜ëŠ” ê²½ìš°ëŠ” ì ì„ ê²ƒ ê°™ì§€ë§Œ, ë§Œì•½ conflictê°€ ë°œìƒí•˜ë©´ ìœ„ ê³µì‹ ë¬¸ì„œë¥¼ ì½ìœ¼ì‹œê³  ì²˜ë¦¬í•˜ì‹œë©´ ë©ë‹ˆë‹¤

## 6ï¸âƒ£ CI/CD

### [1] Perforce + Docker ([ê´€ë ¨ ë¬¸ì„œ](https://www.perforce.com/blog/vcs/how-docker-works))

> ****Why Use Docker with Helix Core?****
> 
> - The basic performance of p4d within a Docker container is very similar to outside a container when it comes to read/write of underlying db.* metadata files (from a directory shared with the host).
> - When using basic Docker network forwarding (from outside the container to the p4d inside the container), there can be a significant performance degradation, around 2x, which is due to the docker-proxy process (and not unexpected). An unexpected result, however, is that running the Docker container with â€œ--net=hostâ€ (which uses host system network stack) does not significantly improve the performance.

> docker compose Compose V2ë¥¼ ì‚¬ìš©í•´ ì»¤ë§¨ë“œë¥¼ `docker-compose` ëŒ€ì‹  `docker compose` ë¡œ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.
í˜¸ìŠ¤íŠ¸ í¬íŠ¸ëŠ” 10001, ì»¨í…Œì´ë„ˆ ë‚´ë¶€ í¬íŠ¸ëŠ” 1666ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
> 

**(1) Dockerfile**

```docker
#Dockerfile
FROM ubuntu:focal

# Update our main system

RUN apt-get update
RUN apt-get dist-upgrade -y

# Get some dependencies for adding apt repositories

RUN apt-get install -y wget gnupg

# Add perforce repo

RUN wget -qO - https://package.perforce.com/perforce.pubkey | apt-key add -
RUN echo 'deb http://package.perforce.com/apt/ubuntu focal release' > /etc/apt/sources.list.d/perforce.list
RUN apt-get update

# Actually install it

RUN apt-get install -y helix-p4d
# RUN apt-get install -y helix-git-connector 

# Go into our directory, start Perforce, and view the log outputs

CMD chown -R perforce:perforce /perforce-data && cd /dbs && p4dctl start master && tail -F /perforce-data/logs/log

```

**(2) docker-compose.yml**

```yaml
# docker-compose.yml
services:
  perforce:
    build: .
    restart: unless-stopped
    volumes:
      - ./p4dctl.conf.d:/etc/perforce/p4dctl.conf.d
      - ./perforce-data:/perforce-data
      - ./dbs:/dbs
    environment:
      - P4PORT=1666
      - P4ROOT=/perforce-data
    ports:
      - 10001:1666
```

**(3) ìˆœì„œ**

1. docker-compose.ymlì—ì„œ `- ./p4dctl.conf.d:/etc/perforce/p4dctl.conf.d` ë¥¼ ìš°ì„  ì£¼ì„ ì²˜ë¦¬í•´ì•¼ í•œë‹¤.
    1. ì„¤ì • íŒŒì¼ì„ ë§Œë“¤ê¸° ìœ„í•¨(ì´ë¼ í•¨)
    2. `mkdir p4dtcl.conf.d` `mkdir perforce-data` `mkdir dbs`ë¡œ ì»¨í…Œì´ë„ˆì— ë°”ì¸ë“œ ë§ˆìš´íŠ¸ ë  ë””ë ‰í† ë¦¬ë¥¼ ë§Œë“¤ì–´ ì¤€ë‹¤.  
    3. `docker compose run -T --rm perforce tar czf - -C /etc/perforce/p4dctl.conf.d . | tar xvzf - -C p4dctl.conf.d/`
        1. `helix-p4d`íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•˜ë©´ `/etc/perforce/p4dctl.conf.d`ì— `README`ì™€ `p4d.template`íŒŒì¼ì´ ìƒê¸´ë‹¤.
        2. ê·¼ë° `gzip` í˜•ì‹ì´ ì•„ë‹ˆë¼ëŠ” ì—ëŸ¬ê°€ ëœ¨ë©´ì„œ ì´ë¯¸ì§€ë§Œ ìƒê¸¸ ìˆ˜ë„ ìˆë‹¤.
            1. ì´ëŸ¬ë©´ ìœ„ `docker compose run...`ë¥¼ ë‹¤ì‹œ ì…ë ¥í•˜ë©´ `p4dctl.conf.d`ì— ìœ„ ë‘ íŒŒì¼ì´ ìƒê¹€ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
    4. `docker images`ë¡œ ë„ì»¤ ì´ë¯¸ì§€ë¥¼ í™•ì¸
        1. ë§Œì•½ ìœ„ì—ì„œ ë§Œë“  ì´ë¯¸ì§€ `perforce/perforce` ê°€ ë‚¨ì•„ìˆìœ¼ë©´ ì‚­ì œ (`docker rmi <ì»¨í…Œì´ë„ˆ ì•„ì´ë””>`)
2. docker-compose.ymlì—ì„œ ì£¼ì„ì„ í•´ì œ
    1. ì´ì œ ì§„ì§œ Helix Core Server ì„¤ì •
    2. `docker compose run --rm perforce /opt/perforce/sbin/configure-helix-p4d.sh`
        1. `/opt/perforce/sbin/configure-helix-p4d.sh`ëŠ” Helix Coreì—ì„œ ì„œë²„ ì„¤ì •ì„ ìœ„í•´ ì‚¬ìš©í•˜ë˜ ì‰˜ íŒŒì¼ì´ë‹¤. (2ï¸âƒ£ - [1] -(2) í™•ì¸)
        2. **ì„œë²„ ì´ë¦„ì€ master, ì„œë²„ rootì€ `/perforce-data`ë¡œ ì„¤ì •. í¬íŠ¸ëŠ” `1666`**
            1. ìŠˆí¼ ìœ ì € ëª…ê³¼ íŒ¨ìŠ¤ì›Œë“œë¥¼ ì§€ì •í•´ ì¤„ ìˆ˜ë„ ìˆë‹¤.
3. `docker compose up --build -d`
    1. Helix Core Server ì‹¤í–‰

**(4) p4 Typemap ì„¤ì •**

1. `docker exec -it {ì»¨í…Œì´ë„ˆ id} /bin/bash`ë¡œ ìœ„ì—ì„œ ì˜¬ë ¤ë†“ì€ ë„ì»¤ ì»¨í…Œì´ë„ˆì— ë“¤ì–´ê°€ê¸°
2.  p4 Typemap ì„¤ì •ì€ ìœ„ 5ï¸âƒ£ì—ì„œ í•œ ê²ƒê³¼ ë§ˆì°¬ê°€ì§€ë¡œ í•˜ë©´ ë¨.

**(5) ì ‘ì†**

ì™¸ë¶€ì—ì„œëŠ” ë§ˆì°¬ê°€ì§€ë¡œ ssl:{í˜¸ìŠ¤íŠ¸ëª…}:{í¬íŠ¸ ë²ˆí˜¸}ë¡œ ì ‘ì†í•˜ë©´ ë¨

### [2] Perforce + Docker + Jenkins ([ê´€ë ¨ ë¬¸ì„œ](https://www.perforce.com/manuals/p4sag/Content/P4SAG/hth-jenkins-ci-builds.html))

```bash
sudo docker run -d --name jenkins --restart=on-failure \
-p 8080:8080 \
-v /var/jenkins_home:/var/jenkins_home \
-v /var/run/docker.sock:/var/run/docker.sock \ #ì´ê²Œ ìˆì–´ì•¼ ì  í‚¨ìŠ¤ ë‚´ë¶€ì—ì„œ ë„ì»¤ ëª…ë ¹ì–´ë¥¼ ì“¸ ìˆ˜ ìˆìŒ
-e TZ=Asia/Seoul \
-u root \
jenkins/jenkins
```

## â“ì˜ë¬¸ì  ì •ë¦¬

### [1] 6ì¸íŒ€ì¸ë° í¼í¬ìŠ¤ ë¬´ë£Œ ë²„ì „ì„ ì“¸ ìˆ˜ ìˆì„ê¹Œ?

- ìœ ì €ëŠ” 5ê°œ ì´í•˜ë¡œ ì´ìš©í•˜ê³  ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë¥¼ ë”°ë¡œ ì“°ëŠ” ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•˜ë©´ ëœë‹¤ê³  í•©ë‹ˆë‹¤. â‡’ ë‹¨ ì´ ê²½ìš°ì—ëŠ” ì„œë¡œ ì¶©ëŒ ì•ˆ ë‚˜ê²Œ ì˜ ì¡°ì •í•´ì•¼ í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤.

![Untitled](manual/Untitled%202.png)

---

## (3) Jenkins

## 1ï¸âƒ£ ì  í‚¨ìŠ¤ ì„¤ì¹˜

```docker
# Dockerfile
FROM jenkins/jenkins:lts
USER root

RUN apt-get update && \
    apt-get -y install apt-transport-https \
      ca-certificates \
      curl \
      gnupg2 \
      software-properties-common && \
    curl -fsSL https://download.docker.com/linux/$(. /etc/os-release; echo "$ID")/gpg > /tmp/dkey; apt-key add /tmp/dkey && \
    add-apt-repository \
      "deb [arch=amd64] https://download.docker.com/linux/$(. /etc/os-release; echo "$ID") \
      $(lsb_release -cs) \
      stable" && \
   apt-get update && \
   apt-get -y install docker-ce

RUN groupadd -f docker
RUN usermod -aG docker jenkins
```

Jenkinsë¥¼ ë„ì»¤ ì»¨í…Œì´ë„ˆ ë‚´ì—ì„œ ê´€ë¦¬í•˜ê¸° ìœ„í•´  `jenkins/jenkins:lts` ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

`RUN groupadd -f docker` 

`RUN usermod -aG docker jenkins`

ìœ„ ë‘ ì¤„ì€ Jenkinsê°€ API ì„œë²„ë¡œ ì‚¬ìš©í•  Spring boot í”„ë¡œì íŠ¸ì˜ ê¹ƒë© ë¦¬í¬ì§€í† ë¦¬ë¥¼ ìë™ ë¹Œë“œí•´ ë„ì»¤ ì»¨í…Œì´ë„ˆì— ë‹´ì„ ê²ƒì´ê¸° ë•Œë¬¸ì—,  `docker` ê·¸ë£¹ì„ ì¶”ê°€í•˜ê³ , `jenkins` ìœ ì €ë¥¼ `docker`ê·¸ë£¹ì— ì¶”ê°€í•´ì¤ë‹ˆë‹¤.

```docker
# docker-compose.yml
services:
  jenkins:
    build : .
    restart: unless-stopped
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    ports:
      - 8081:8080
      - 50000:50000
```

ë¹Œë“œëŠ” Docker composeë¥¼ í†µí•´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. `sudo docker compose up -d` ë¡œ ë°”ë¡œ ë¹Œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Jenkins ì»¨í…Œì´ë„ˆ ë‚´ì—ì„œ ë„ì»¤ë¥¼ ì‚¬ìš©í•˜ê²Œ ë  í…ë°, ì´ë¥¼ ìœ„í•´ í¬íŠ¸ë¥¼ í•˜ë‚˜ ë” ì—´ê³  ë‘ ê°œì˜ ì»¨í…Œì´ë„ˆ(Jenkins ì»¨í…Œì´ë„ˆì™€, Jenkins ì»¨í…Œì´ë„ˆ ë‚´ì—ì„œ ë§Œë“¤ì–´ì§ˆ Spring boot ì»¨í…Œì´ë„ˆ)ë¥¼ ê±°ì³ ì ‘ì†í•˜ëŠ” ê²ƒì€ ë¹„íš¨ìœ¨ì ì´ë¯€ë¡œ í˜¸ìŠ¤íŠ¸ì˜ ë„ì»¤ ì†Œì¼“ê³¼ ë°”ì¸ë“œí•´ ë„ì»¤ ë°ëª¬ì„ ê³µìœ í•˜ë„ë¡ í•©ë‹ˆë‹¤. 

ì´ë ‡ê²Œ ë„ì»¤ ì»¨í…Œì´ë„ˆê°€ ë§Œë“¤ì–´ì§€ë©´, `sudo docker exec -it -u root {jenkins ì»¨í…Œì´ë„ˆ ì´ë¦„} bash` ë¡œ Jenkinsì— `root` ìœ ì €ë¡œ ë“¤ì–´ê°€ `chown root:docker /var/run/docker.sock`ë¥¼ ì…ë ¥í•´ `docker` ê·¸ë£¹ì— `/var/run/docker.sock`ì— ëŒ€í•œ ê¶Œí•œì„ ë¶€ì—¬í•©ë‹ˆë‹¤.

## 2ï¸âƒ£ GitLab Webhook ì„¤ì •

### (1) Jenkins

ë¸Œë¼ìš°ì €ì—ì„œ EC2 ë„ë©”ì¸ : 8081 (ì´ í”„ë¡œì íŠ¸ì—ì„œëŠ” [http://j9a203.p.ssafy.io:8081](http://j9a203.p.ssafy.io:8081/login?from=%2F))ìœ¼ë¡œ Jenkins Consoleì— ì ‘ì†í•©ë‹ˆë‹¤.

![Untitled](manual/Untitled%203.png)

ì ‘ì† ì‹œì— ìœ„ì™€ ê°™ì´ ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ê²Œ í•©ë‹ˆë‹¤. ì‰˜ì—ì„œ `sudo docker exec -it {ì»¨í…Œì´ë„ˆëª…} cat /var/jenkins_home/secrets/initialAdminPassword` ì„ ì…ë ¥í•˜ë©´ í•´ë‹¹í•˜ëŠ” ë¹„ë°€ë²ˆí˜¸ë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤.

![Untitled](manual/Untitled%204.png)

![Untitled](manual/Untitled%205.png)

ì œëŒ€ë¡œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ë©´ ìœ„ì™€ ê°™ì´ í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í•˜ë¼ëŠ” í˜ì´ì§€ê°€ ë‚˜ì˜µë‹ˆë‹¤. ì¼ë‹¨ì€ ê¶Œì¥ í”ŒëŸ¬ê·¸ì¸ë“¤ì„ ì„¤ì¹˜í•˜ë„ë¡ í•©ë‹ˆë‹¤. ì´í›„ì—ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì–´ë“œë¯¼ ìœ ì €ë¥¼ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.

![Untitled](manual/Untitled%206.png)

![Untitled](manual/Untitled%207.png)

ê³„ì† ì§„í–‰í•˜ë©´ Jenkins Dashboardê°€ ë‚˜ì˜µë‹ˆë‹¤. ìš°ì„  Jenkins ê´€ë¦¬ â†’ Plugins â†’ Available Pluginsì—ì„œ GitLabê³¼ Dockerë¥¼ ê²€ìƒ‰í•´ ì„¤ì¹˜í•©ë‹ˆë‹¤. ì´í›„ ìƒˆë¡œìš´ Item ì¶”ê°€ë¥¼ ëˆŒëŸ¬ Freestyle Projectë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. 

ì´í›„ ì™¼ìª½ì˜ êµ¬ì„±ì„ ëˆŒëŸ¬ ì„¤ì •ì„ í•´ì¤ë‹ˆë‹¤.

![Untitled](manual/Untitled%208.png)

![Untitled](manual/Untitled%209.png)

ì›¹í›…ì„ ë‹¬ ê¹ƒë©ì˜ ë¦¬í¬ì§€í† ë¦¬ URLì„ ì¶”ê°€í•©ë‹ˆë‹¤. ë§Œì•½ Credentialsë¥¼ ì¶”ê°€í•˜ì§€ ì•Šì•˜ë‹¤ë©´ ìœ„ì™€ ê°™ì´ ë¶‰ì€ ê¸€ì”¨ê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤. Credentials ë°”ë¡œ ì•„ë˜ì˜ Addë¥¼ ëˆ„ë¥´ê³  Jenkinsë¥¼ ëˆŒëŸ¬ ìƒˆë¡œìš´ Credentialì„ ì¶”ê°€í•´ì¤ë‹ˆë‹¤.

![Untitled](manual/Untitled%2010.png)

Usernameì€ ê¹ƒë©ì—ì„œ ì‚¬ìš©í•˜ê³  ìˆëŠ” ê³„ì •ì´ê³ , PasswordëŠ” í•´ë‹¹ ë¦¬í¬ì§€í† ë¦¬ì—ì„œ ì–»ì€ Access Tokenì„ ì…ë ¥í•©ë‹ˆë‹¤. ì•„ë˜ì˜ IDì™€ Descriptionì€ ììœ ì…ë‹ˆë‹¤. Addë¥¼ ëˆŒëŸ¬ Credentialì„ ì¶”ê°€í•˜ê³ , Credentials ë“œë¡­ë‹¤ìš´ì—ì„œ ë“±ë¡í•œ Credentialì„ ì„ íƒí•˜ë©´ ë¶‰ì€ ê¸€ì”¨ê°€ ì‚¬ë¼ì§‘ë‹ˆë‹¤.

![Untitled](manual/Untitled%2011.png)

ì•„ë˜ì—ì„œëŠ” ë¹Œë“œë  íƒ€ê²Ÿ ë¸Œëœì¹˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. ë§ˆìŠ¤í„° ë¸Œëœì¹˜ì— í‘¸ì‹œê°€ ë  ë•Œë§ˆë‹¤ ë§ˆìŠ¤í„° ë¸Œëœì¹˜ë¥¼ ë¹Œë“œí•  ê²ƒì´ë¯€ë¡œ ìœ„ì™€ ê°™ì´ ë‘¡ë‹ˆë‹¤.

![Untitled](manual/Untitled%2012.png)

ì•„ë˜ëŠ” ì–´ë–¤ ê²½ìš°ì— ë¹Œë“œë¥¼ ì‹œì‘í•  ê²ƒì¸ì§€ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. Build when a changeâ€¦ë¥¼ ì²´í¬í•©ë‹ˆë‹¤. ë§Œì•½ í•´ë‹¹ ì²´í¬ ë°•ìŠ¤ê°€ ì—†ë‹¤ë©´ GitLab í”ŒëŸ¬ê·¸ì¸ì´ ì„¤ì¹˜ë˜ì§€ ì•Šì€ ê²ƒì´ë¯€ë¡œ ì„¤ì¹˜í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤. ë’¤ì˜ Webhook URLì€ ë”°ë¡œ ì €ì¥í•´ë‘¡ë‹ˆë‹¤. ì´í›„ ìŠ¤í¬ë¡¤ì„ ë‚´ë ¤ ê³ ê¸‰ì„ í´ë¦­í•˜ê³  ë” ê°€ë©´ Secret Tokenì´ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ì˜ Generate ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ í† í°ì´ ìƒì„±ë©ë‹ˆë‹¤. ì´ í† í°ë„ ë”°ë¡œ ì €ì¥í•´ë‘¡ë‹ˆë‹¤.

![Untitled](manual/Untitled%2013.png)

ì´í›„ ì¼ë‹¨ì„ ì €ì¥ì„ í•©ë‹ˆë‹¤.

### (2) GitLab

ì›¹í›…ì„ ì¶”ê°€í•  ë¦¬í¬ì§€í† ë¦¬ì— ê°‘ë‹ˆë‹¤.

![Untitled](manual/Untitled%2014.png)

ì™¼ìª½ì˜ Settings â†’ Webhooksë¡œ ê°‘ë‹ˆë‹¤. ìœ„ì—ì„œ ë”°ë¡œ ì €ì¥í•œ Webhook URLê³¼ Secret Tokenì„ ê°ê° ì…ë ¥í•˜ê³  ì›í•˜ëŠ” íŠ¸ë¦¬ê±°ë¥¼ ì„ íƒí•©ë‹ˆë‹¤. ì´ í”„ë¡œì íŠ¸ì—ì„œëŠ” masterì— push ì´ë²¤íŠ¸ê°€ ì¼ì–´ë‚˜ëŠ” ê²½ìš°ì— ë¹Œë“œë¥¼ ì‹œì‘í•  ê²ƒì´ë¯€ë¡œ ì•„ë˜ì™€ ê°™ì´ ì„¤ì •í–ˆìŠµë‹ˆë‹¤.

![Untitled](manual/Untitled%2015.png)

![Untitled](manual/Untitled%2016.png)

Save Changesë¥¼ í´ë¦­í•˜ê³  Testë¥¼ ëˆŒëŸ¬ Push Eventë¥¼ ì„ íƒí•©ë‹ˆë‹¤. ì›¹í›…ì´ ì œëŒ€ë¡œ ì„¤ì •ë˜ì—ˆë‹¤ë©´ `200` ìƒíƒœ ì½”ë“œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![Untitled](manual/Untitled%2017.png)

## (4) MySQL

```docker
# docker-compose.yml
services:
  db:
    image: mysql:latest
    container_name: mysql
    restart: always
    volumes:
       - ./db:/var/lib/mysql
    ports:
      - 3306:3306
    environment:
      - MYSQL_ROOT_PASSWORD=admin
      - MYSQL_DATABASE=goldking
      - TZ=Asia/Seoul
    command:
      - --character-set-server=utf8mb4
      - --collation-server=utf8mb4_unicode_ci
```

MySQLì€ `mysql:latest` ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. DBì¸ ë§Œí¼ ì»¨í…Œì´ë„ˆì— ë¬¸ì œê°€ ìƒê²¨ë„ ë°ì´í„°ê°€ íœ˜ë°œë˜ì–´ì„œëŠ” ì•ˆë˜ê¸° ë•Œë¬¸ì— í˜¸ìŠ¤íŠ¸ì— ë°”ì¸ë“œ ì‹œì¼œì¤ë‹ˆë‹¤. `environment`ì—ëŠ” Root  Userì˜ ë¹„ë°€ ë²ˆí˜¸ë¥¼ ì„¤ì •í•˜ê³ , ì‚¬ìš©ë  ë°ì´í„°ë² ì´ìŠ¤ë¥¼ í•˜ë‚˜ ë§Œë“¤ë©°, ì‹œê°„ëŒ€ë¥¼ ì„¤ì •í•´ì¤ë‹ˆë‹¤. `command`ì—ì„œëŠ” ë¬¸ì ì¸ì½”ë”©ì„ ì§€ì •í•©ë‹ˆë‹¤. ì•ì„œì™€ ë§ˆì°¬ê°€ì§€ë¡œ `sudo docker compose up -d`ë¡œ ë¹Œë“œí•©ë‹ˆë‹¤.

![Untitled](manual/Untitled%2018.png)

Spring boot í”„ë¡œì íŠ¸ì˜ `build.gradle`íŒŒì¼ ì…ë‹ˆë‹¤. MySQLì„ ì“°ê¸° ìœ„í•´ì„œëŠ”  `mysql:mysql-connector-java:8.0.32` ì™€ `org.springframework.boot:spring-boot-starter-jdbc`ì˜ dependencyë¥¼ ì¶”ê°€í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤. í”„ë¡œì íŠ¸ì—ì„œ JPAë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ì¶”ê°€í•œ `org.springframework.boot:spring-boot-starter-data-jpa`ì— ì´ë¯¸ `org.springframework.boot:spring-boot-starter-jdbc` ê°€ í¬í•¨ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ë”°ë¡œ ë”°ë¡œ ì¶”ê°€í•  í•„ìš”ëŠ” ì—†ìŠµë‹ˆë‹¤.

ì•„ë˜ëŠ” í”„ë¡œì íŠ¸ì˜ `[application.properties](http://application.properties)` íŒŒì¼ì…ë‹ˆë‹¤. MySQLì„ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ë“œë¼ì´ë²„, DBì˜ URLì„ ì…ë ¥í•´ì¤ë‹ˆë‹¤. EC2 ì¸ìŠ¤í„´ìŠ¤ì— ì˜¬ë¼ê°„ 3306 í¬íŠ¸ì˜ MySQLì„ ì‚¬ìš©í•  ê²ƒì´ë¯€ë¡œ í˜¸ìŠ¤íŠ¸ ë° í¬íŠ¸ëŠ” `j9a203.p.ssafy.io:3306`ë¡œ ì§€ì •í•©ë‹ˆë‹¤. ì´ ë•Œ ì‚¬ìš©í•  ë°ì´í„°ë² ì´ìŠ¤ê°€ `goldking` ë°ì´í„°ë² ì´ìŠ¤ì´ê³  ì‹œê°„ ë˜í•œ `Asia/Seoul`ë¡œ ì§€ì •ë˜ì–´ ìˆìœ¼ë‹ˆ ì§€ì •í•´ì¤ë‹ˆë‹¤.

ì‚¬ìš©ìì˜ ì´ë¦„ê³¼ ë¹„ë°€ë²ˆí˜¸ ë˜í•œ ì§€ì •í•©ë‹ˆë‹¤. ê°„ë‹¨íˆ Root Userë¥¼ ì‚¬ìš©í•  ê²ƒì´ë¯€ë¡œ ì‚¬ìš©ìëª…ì€ `root`, ë¹„ë°€ë²ˆí˜¸ë¡œëŠ” ìœ„ì—ì„œ ì§€ì •í•œ `admin`ì„ ì…ë ¥í•©ë‹ˆë‹¤.

ê·¸ ì•„ë˜ ë‹¨ë½ì€ JPAë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ dialectë“±ì˜ ì„¤ì •ë“¤ì´ ìˆìŠµë‹ˆë‹¤. í…Œì´ë¸”ì˜ ìƒì„± ë˜í•œ JPAì— ë§¡ê¸¸ ê²ƒì´ë¯€ë¡œ ì²« ë²ˆ ì§¸ ë¹Œë“œ ì‹œì—ëŠ” ë§¨ ì•„ë˜ì˜ `spring.jpa.hibernate.ddl-auto=create`ì˜  ì£¼ì„ì„ í•´ì œí•´ì£¼ê³ , ì´í›„ì—ëŠ” ë‹¤ì‹œ ì£¼ì„ ì²˜ë¦¬í•´ ì‚¬ìš©í•©ë‹ˆë‹¤.

![Untitled](manual/Untitled%2019.png)

## (5) Jenkinsë¥¼ í†µí•œ Spring Boot í”„ë¡œì íŠ¸ ë¹Œë“œ

Spring Boot í”„ë¡œì íŠ¸ëŠ” Gradleì„ ì´ìš©í•´ ë¹Œë“œë˜ê³  ìˆìŠµë‹ˆë‹¤. master ë¸Œëœì¹˜ì— push ëì„ ë•Œ ë°”ë¡œ í”„ë¡œì íŠ¸ê°€ ë¹Œë“œë  ìˆ˜ ìˆë„ë¡ ì„¸íŒ…ì„ ì§„í–‰í•©ë‹ˆë‹¤.

Spring Boot í”„ë¡œì íŠ¸ ë‚´ì— Dockerfileê³¼ docker-compose.ymlì„ ì¶”ê°€í•©ë‹ˆë‹¤.

```docker
#Dockerfile
FROM openjdk:17
COPY build/libs/*.jar app.jar
ENTRYPOINT ["java","-jar","/app.jar"]
```

Spring boot 3ë¥¼ ì‚¬ìš©í•˜ê³  ìˆê¸°ì— java 17ì´ í•„ìš”í•˜ë¯€ë¡œ í•´ë‹¹ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. gradleì„ ì´ìš©í•´ ë¹Œë“œí•´ì„œ ë‚˜ì˜¤ëŠ” jar íŒŒì¼ì´ build/libsì— ìœ„ì¹˜í•˜ë¯€ë¡œ í•´ë‹¹ íŒŒì¼ì„ í˜„ì¬ ìœ„ì¹˜ë¡œ ë³µì‚¬í•˜ê³  ì—”íŠ¸ë¦¬ í¬ì¸íŠ¸ë¡œ ì‹¤í–‰í•©ë‹ˆë‹¤.

```docker
# docker-compose.yml
services:
  spring:
    build: .
    ports:
      - 8080:8080
```

ìœ„ ë„ì»¤ íŒŒì¼ì€ docker-composeë¥¼ ì´ìš©í•´ ë¹Œë“œí•©ë‹ˆë‹¤. í¬íŠ¸ëŠ” EC2 í˜¸ìŠ¤íŠ¸ì™€ ë„ì»¤ ì»¨í…Œì´ë„ˆ ëª¨ë‘ 8080ì„ ì‚¬ìš©í•˜ê²Œ ì§€ì •í–ˆìŠµë‹ˆë‹¤.

ìœ„ Spring boot í”„ë¡œì íŠ¸ë¥¼ Jenkins ë‚´ì—ì„œ ë¹Œë“œí•´ì•¼ í•˜ëŠ”ë° Jenkinsê°€ ê¸°ë³¸ì ìœ¼ë¡œ openjdk-11ì„ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë¯€ë¡œ, Jenkins ì»¨í…Œì´ë„ˆ ë‚´ì—ì„œ Spring boot 3í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œë¥¼ í•  ìˆ˜ëŠ” ì—†ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ openjdk-17ì„ ì„¤ì¹˜í•˜ê³  í•´ë‹¹ íŒŒì¼ì„ ë¹Œë“œí•˜ëŠ” ë°ì— ì‚¬ìš©í•˜ë„ë¡ ì§€ì •í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.

`sudo docker exec -it -u root {jenkins ì»¨í…Œì´ë„ˆ ëª…} bash` ë¡œ í•´ë‹¹ ì»¨í…Œì´ë„ˆì— ì ‘ì†í•©ë‹ˆë‹¤.

```bash
apt-get update
apt-get upgrade
apt-get install openjdk-17-jdk
```

ì»¨í…Œì´ë„ˆ ë‚´ì— openjdk-17-jdkë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤. ì•„ë˜ëŠ” ì„¤ì¹˜ê°€ ì™„ë£Œëœ ëª¨ìŠµì…ë‹ˆë‹¤.

![Untitled](manual/Untitled%2020.png)

ë¡œê·¸ì—ì„œ ë³¼ ìˆ˜ ìˆëŠ” `/usr/lib/jvm/java-17-openjdk-amd64` ë¥¼ ë³µì‚¬í•´ë‘¡ë‹ˆë‹¤.

ë‹¤ì‹œ Jenkins Consoleë¡œ ëŒì•„ê°€ì„œ Jenkins ê´€ë¦¬ â†’ Tools â†’ JDK Installationsë¡œ ê°‘ë‹ˆë‹¤. Add JDK ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ë‹¤ìŒê³¼ ê°™ì´ ëœ¹ë‹ˆë‹¤.

![Untitled](manual/Untitled%2021.png)

Nameì—ëŠ” ì›í•˜ëŠ” ì´ë¦„ì„ ì…ë ¥í•˜ê³ , JAVA_HOMEì—ëŠ” ë³µì‚¬í–ˆë˜ `/usr/lib/jvm/java-17-openjdk-amd64` ë¥¼ ì…ë ¥í•˜ê³  ì €ì¥í•©ë‹ˆë‹¤. ì´ì œ JenkinsëŠ” Java í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•  ë•Œ Java 17ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ì „ì— ì¶”ê°€í–ˆë˜ í”„ë¡œì íŠ¸ì˜ êµ¬ì„±ìœ¼ë¡œ ë‹¤ì‹œ ê°€ì„œ ë§¨ ì•„ë˜ì˜ Build Stepsë¥¼ ì¶”ê°€í•´ì¤ë‹ˆë‹¤.

![Untitled](manual/Untitled%2022.png)

ì—¬ê¸°ì„œ Execute Shellì„ í´ë¦­í•©ë‹ˆë‹¤.

![Untitled](manual/Untitled%2023.png)

```bash
cd a203
chmod +x gradlew
./gradlew clean build

docker compose down --rmi all
docker compose up -d
```

ì´ í”„ë¡œì íŠ¸ì—ì„œ í”„ë¡œì íŠ¸ í´ë”ëŠ” a203ì— ìˆìœ¼ë¯€ë¡œ í•´ë‹¹ í´ë”ì— ë“¤ì–´ê°‘ë‹ˆë‹¤. ë¹Œë“œë¥¼ í•˜ê¸° ìœ„í•œ gradlewì— ê¶Œí•œì„ ì£¼ê³  ë¹Œë“œë¥¼ ì‹œì‘í•©ë‹ˆë‹¤. ë¹Œë“œê°€ ë‹¤ ë˜ê³  ë‚˜ë©´ ê¸°ì¡´ì— ìˆì„ ìˆ˜ë„ ìˆëŠ” ë„ì»¤ ì»¨í…Œì´ë„ˆì™€ ì´ë¯¸ì§€ë¥¼ ëª¨ë‘ ì‚­ì œí•˜ê³  ìƒˆë¡œ ë„ì»¤ ì»¨í…Œì´ë„ˆë¥¼ ë¹Œë“œí•´ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰ í•©ë‹ˆë‹¤.